#!/bin/bash

# STOP PREVIOUS SERVERS
# ---------------------
/usr/local/stationeers/stop >> /dev/null 2>&1

# VARIABLES
# ---------
SECURE=$(cat /usr/local/stationeers/config | grep secure: | awk '{ print $2 }')
WORLDNAME=$(cat /usr/local/stationeers/config | grep worldname: | awk '{ print $2 }')
WORLDTYPE=$(cat /usr/local/stationeers/config | grep worldtype: | awk '{ print $2 }')
PASSWORD=$(cat /usr/local/stationeersconfig | grep password: | awk '{ print $2 }')
SERVERNAME=$(cat /usr/local/stationeers/config | grep servername: | awk '{ print $2 }')

#########################################################################################################################

if [ $SECURE = yes ]
then
	echo "------------------------------------------"
	echo
	echo "Secure: $SECURE"
	echo "Name: $WORLDNAME"
	echo "Type $WORLDTYPE"
	echo "Password: $PASSWORD"
	echo "Servername: $SERVERNAME"
	echo
	echo "------------------------------------------"

	~/Steam/steamapps/common/Stationeers\ Dedicated\ Server/rocketstation_DedicatedServer.x86_64 \
        -autostart \
        -batchmode \
        -nographics \
        -password=$PASSWORD \
        -autosaveinterval=300 \
        -clearallinterval=65535 \
        -loadworld=$WORLDNAME \
        -worldtype=$WORLDTYPE \
        -worldname=$WORLDNAME \
        -servername=$SERVERNAME \
        -basedirectory=server/ \
        &

elif [ $SECURE = no ]
then
	echo "------------------------------------------"
	echo
	echo "Secure: $SECURE"
	echo "Name: $WORLDNAME"
	echo "Type $WORLDTYPE"
	echo "Servername: $SERVERNAME"
	echo
	echo "------------------------------------------"

	~/Steam/steamapps/common/Stationeers\ Dedicated\ Server/rocketstation_DedicatedServer.x86_64 \
        -autostart \
        -batchmode \
        -nographics \
        -autosaveinterval=300 \
        -clearallinterval=65535 \
        -loadworld=$WORLDNAME \
        -worldtype=$WORLDTYPE \
        -worldname=$WORLDNAME \
        -servername=$SERVERNAME \
        -basedirectory=server/ \
        &
else
        echo "ERROR"
fi
